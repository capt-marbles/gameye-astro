---
import SectionParticles from './SectionParticles.astro';

const testimonials = [
  {
    company: 'Torn Banner Studios',
    quote:
      'Match quality improved with tighter server behavior and better consistency between regions during peak events.',
    name: 'Production Team',
    role: 'Chivalry 2',
    image: 'https://gameye.com/wp-content/uploads/2024/01/chivalry2-testimonial.png',
    logo: 'https://gameye.com/wp-content/uploads/2024/01/torn-banner-testimonial-logo.png',
  },
  {
    company: 'Doborog Games',
    quote:
      'We reduced operator overhead by centralizing orchestration and observability into one deployment workflow.',
    name: 'Backend Team',
    role: 'Studio Infrastructure',
    image: 'https://gameye.com/wp-content/uploads/2024/01/doborog-testimonials-min.png',
    logo: 'https://gameye.com/wp-content/uploads/2024/01/doborog-logo-testimonials-min.png',
  },
  {
    company: 'Oddshot Games',
    quote:
      'Server rollout velocity increased and troubleshooting cycles shortened after moving to a unified session platform.',
    name: 'Platform Team',
    role: 'Live Ops',
    image: 'https://gameye.com/wp-content/uploads/2024/01/oddshot-games.png',
    logo: 'https://gameye.com/wp-content/uploads/2024/01/oddshot-games-logo.png',
  },
  {
    company: 'Secret 6',
    quote:
      'Global orchestration helped us stabilize multiplayer behavior across varied player geography and ISP conditions.',
    name: 'Network Team',
    role: 'Multiplayer Engineering',
    image: 'https://gameye.com/wp-content/uploads/2024/01/secret-six-testimonial.png',
    logo: 'https://gameye.com/wp-content/uploads/2024/01/secret-6-logo-testimonial.png',
  },
];

const loop = [...testimonials, ...testimonials];
---

<section class="section testimonials-section">
  <SectionParticles count={7} />
  <div class="container">
    <div class="heading">
      <p class="subtitle">Reusable Section</p>
      <h2>Testimonial carousel</h2>
    </div>

    <div class="carousel" aria-label="Customer testimonials">
      <div class="track">
        {loop.map((item, index) => (
          <article class="card" aria-hidden={index >= testimonials.length ? 'true' : undefined}>
            <figure class="media">
              <img src={item.image} alt={`${item.company} case study visual`} loading="lazy" decoding="async" />
            </figure>
            <div class="content">
              <img class="logo" src={item.logo} alt={`${item.company} logo`} loading="lazy" decoding="async" />
              <p class="quote">"{item.quote}"</p>
              <p class="meta">{item.name} Â· {item.role}</p>
            </div>
          </article>
        ))}
      </div>
    </div>
  </div>
</section>

<style>
  .testimonials-section {
    position: relative;
    overflow: hidden;
    background: var(--gy-color-bg);
    padding: 4.8rem 0;
    margin: 3.6rem 0;
  }

  .testimonials-section .container {
    position: relative;
    z-index: 1;
  }

  .heading {
    text-align: center;
    margin-bottom: 3rem;
  }

  .heading .subtitle,
  .heading h2 {
    margin: 0 0 0.5rem 0;
  }

  .carousel {
    margin-top: 0;
    overflow: hidden;
    mask-image: linear-gradient(to right, transparent, #000 8%, #000 92%, transparent);
    -webkit-mask-image: linear-gradient(to right, transparent, #000 8%, #000 92%, transparent);
  }

  .track {
    width: max-content;
    display: flex;
    gap: 2rem;
    animation: gy-testimonial-scroll 58s linear infinite;
  }

  .carousel:hover .track {
    animation-play-state: paused;
  }

  .card {
    width: min(34rem, 82vw);
    display: grid;
    grid-template-columns: 40% 1fr;
    gap: 1.5rem;
    border-radius: var(--gy-radius-xl);
    border: none;
    background: var(--gy-color-white);
    padding: 0;
  }

  .media {
    margin: 0;
    border-radius: calc(var(--gy-radius-lg) - 4px);
    overflow: hidden;
    min-height: 11rem;
  }

  .media img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .content {
    padding: 2rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .logo {
    max-width: 12rem;
    max-height: 4rem;
    object-fit: contain;
  }

  .quote {
    margin-top: 0;
    color: var(--gy-color-alt-dark-blue);
    font-size: 1.6rem;
    line-height: 1.4;
    font-weight: 250;
  }

  .meta {
    margin-top: 1.5rem;
    font-size: 1rem;
    color: color-mix(in srgb, var(--gy-color-alt-dark-blue) 78%, #fff);
  }

  @keyframes gy-testimonial-scroll {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(calc(-50% - 1rem));
    }
  }

  @media (max-width: 860px) {
    .card {
      width: min(30rem, 90vw);
      grid-template-columns: 1fr;
    }

    .media {
      min-height: 10rem;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .carousel {
      overflow-x: auto;
      mask-image: none;
      -webkit-mask-image: none;
    }

    .track {
      animation: none;
      width: auto;
      flex-wrap: nowrap;
    }
  }
</style>
