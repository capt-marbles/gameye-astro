---
import MarketingPageLayout from '../../../layouts/MarketingPageLayout.astro';
import { comparisonPages } from '../../../data/comparison-pages';

export function getStaticPaths() {
  return comparisonPages.map((page) => ({
    params: { slug: page.slug },
    props: { page },
  }));
}

const { page } = Astro.props;

const currentIndex = comparisonPages.findIndex((item) => item.slug === page.slug);
const relatedPages = comparisonPages.filter((item) => item.slug !== page.slug).slice(0, 3);
const previousPage = currentIndex > 0 ? comparisonPages[currentIndex - 1] : null;
const nextPage = currentIndex < comparisonPages.length - 1 ? comparisonPages[currentIndex + 1] : null;

const faqStructuredData = {
  '@type': 'FAQPage',
  mainEntity: page.faq.map((item) => ({
    '@type': 'Question',
    name: item.question,
    acceptedAnswer: {
      '@type': 'Answer',
      text: item.answer,
    },
  })),
};

const breadcrumbStructuredData = {
  '@type': 'BreadcrumbList',
  itemListElement: [
    {
      '@type': 'ListItem',
      position: 1,
      name: 'Comparison',
      item: 'https://gameye.com/comparison/',
    },
    {
      '@type': 'ListItem',
      position: 2,
      name: page.title,
      item: page.canonical,
    },
  ],
};
---

<MarketingPageLayout
  title={page.title}
  description={page.description}
  canonical={page.canonical}
  ogType="article"
  ogImage="https://gameye.com/wp-content/uploads/2023/12/cropped-Gameye-server-hosting.jpg"
  ogImageAlt={`Gameye vs ${page.competitor} comparison`}
  schemaType="WebPage"
  schemaName={page.title}
  structuredData={[faqStructuredData, breadcrumbStructuredData]}
>
  <section class="section page-hero">
    <div class="container">
      <p class="subtitle">Comparison</p>
      <h1>{page.title}</h1>
      <p class="lead">{page.heroLead}</p>
      <p class="summary">{page.summary}</p>
      <div class="actions">
        <a class="button primary" href="/contact-us/">Talk with infrastructure specialists</a>
        <a class="button secondary" href="/pricing/">Estimate pricing impact</a>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container split-grid">
      <article class="panel">
        <h2>Where Gameye stands out</h2>
        <ul>
          {page.gameyeStrengths.map((item) => (
            <li>{item}</li>
          ))}
        </ul>
      </article>
      <article class="panel">
        <h2>Where {page.competitor} can fit</h2>
        <ul>
          {page.alternativeFit.map((item) => (
            <li>{item}</li>
          ))}
        </ul>
      </article>
    </div>
  </section>

  <section class="section">
    <div class="container table-wrap">
      <h2>Capability comparison</h2>
      <table class="compare-table">
        <thead>
          <tr>
            <th>Capability</th>
            <th>Gameye</th>
            <th>{page.competitor}</th>
          </tr>
        </thead>
        <tbody>
          {page.capabilities.map((row) => (
            <tr>
              <td>{row.capability}</td>
              <td>{row.gameye}</td>
              <td>{row.alternative}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  </section>

  <section class="section">
    <div class="container migration">
      <div>
        <p class="subtitle">Migration Planning</p>
        <h2>Practical move path</h2>
      </div>
      <ol>
        {page.migrationPlan.map((step) => (
          <li>{step}</li>
        ))}
      </ol>
    </div>
  </section>

  <section class="section">
    <div class="container faq-list">
      <h2>Frequently asked questions</h2>
      {page.faq.map((item) => (
        <details>
          <summary>{item.question}</summary>
          <p>{item.answer}</p>
        </details>
      ))}
    </div>
  </section>

  <section class="section">
    <div class="container route-links">
      <a href="/comparison/">Back to comparison hub</a>
      <a href="/platform/">Platform overview</a>
      <a href="/how-it-works/">How it works</a>
      <a href="/docs/">Documentation</a>
    </div>
  </section>

  <section class="section">
    <div class="container related">
      <h2>Related comparisons</h2>
      <div class="related-grid">
        {relatedPages.map((item) => (
          <article class="related-card">
            <h3>{item.competitor}</h3>
            <p>{item.description}</p>
            <a href={`/comparison/${item.slug}/`}>Open comparison</a>
          </article>
        ))}
      </div>
      <div class="pagination-links">
        {previousPage ? <a href={`/comparison/${previousPage.slug}/`}>Previous: {previousPage.competitor}</a> : <span></span>}
        {nextPage ? <a href={`/comparison/${nextPage.slug}/`}>Next: {nextPage.competitor}</a> : <span></span>}
      </div>
    </div>
  </section>
</MarketingPageLayout>

<style>
  .page-hero .lead {
    margin-top: 1rem;
    max-width: 74ch;
    font-size: 1.12rem;
  }

  .summary {
    margin-top: 0.8rem;
    max-width: 70ch;
    color: var(--gy-color-alt-dark-blue);
  }

  .actions {
    margin-top: 1.4rem;
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
  }

  .split-grid {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 1rem;
  }

  .panel {
    border: 1px solid color-mix(in srgb, var(--gy-color-dark-blue) 12%, #fff);
    border-radius: var(--gy-radius-lg);
    background: var(--gy-color-white);
    padding: 1.2rem;
  }

  .panel h2 {
    font-size: 1.8rem;
  }

  .panel ul {
    margin: 0.9rem 0 0;
    padding-left: 1.1rem;
    display: grid;
    gap: 0.6rem;
  }

  .table-wrap h2 {
    margin-bottom: 0.9rem;
  }

  .table-wrap {
    overflow-x: auto;
  }

  .compare-table {
    width: 100%;
    min-width: 50rem;
    border-collapse: collapse;
    background: var(--gy-color-white);
  }

  .compare-table th,
  .compare-table td {
    border: 1px solid color-mix(in srgb, var(--gy-color-dark-blue) 20%, #fff);
    padding: 0.85rem;
    text-align: left;
    vertical-align: top;
  }

  .compare-table thead th {
    background: var(--gy-color-bg-alt);
    font-weight: 500;
  }

  .migration {
    border: 1px solid color-mix(in srgb, var(--gy-color-dark-blue) 12%, #fff);
    border-radius: var(--gy-radius-lg);
    background: var(--gy-color-bg-alt);
    padding: 1.4rem;
    display: grid;
    gap: 0.95rem;
  }

  .migration ol {
    margin: 0;
    padding-left: 1.15rem;
    display: grid;
    gap: 0.65rem;
  }

  .faq-list h2 {
    margin-bottom: 0.95rem;
  }

  .faq-list details {
    border: 1px solid color-mix(in srgb, var(--gy-color-dark-blue) 12%, #fff);
    border-radius: var(--gy-radius-md);
    background: var(--gy-color-white);
    padding: 0.95rem 1rem;
  }

  .faq-list details + details {
    margin-top: 0.7rem;
  }

  .faq-list summary {
    cursor: pointer;
    font-weight: 500;
    color: var(--gy-color-dark-blue);
  }

  .faq-list p {
    margin-top: 0.6rem;
  }

  .route-links {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .route-links a {
    text-decoration: none;
    border: 1px solid color-mix(in srgb, var(--gy-color-dark-blue) 16%, #fff);
    border-radius: 999px;
    padding: 0.55rem 0.95rem;
    color: var(--gy-color-alt-dark-blue);
  }

  .related h2 {
    margin-bottom: 0.95rem;
  }

  .related-grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 1rem;
  }

  .related-card {
    border: 1px solid color-mix(in srgb, var(--gy-color-dark-blue) 12%, #fff);
    border-radius: var(--gy-radius-lg);
    background: var(--gy-color-white);
    padding: 1rem;
    display: grid;
    gap: 0.65rem;
  }

  .related-card h3 {
    font-size: 1.4rem;
    font-weight: 500;
  }

  .related-card a {
    color: var(--gy-color-alt-dark-blue);
    text-decoration: none;
    font-weight: 500;
  }

  .pagination-links {
    margin-top: 1.1rem;
    display: flex;
    justify-content: space-between;
    gap: 0.75rem;
    flex-wrap: wrap;
  }

  .pagination-links a {
    color: var(--gy-color-alt-dark-blue);
    text-decoration: none;
    font-weight: 500;
  }

  @media (max-width: 980px) {
    .split-grid,
    .related-grid {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 760px) {
    .compare-table {
      min-width: 44rem;
    }
  }
</style>
